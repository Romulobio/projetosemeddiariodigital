<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Audiowide&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles-relatorios.css">
    <title>Relat√≥rios de Frequ√™ncia</title>
</head>
<body>
    
    <!-- Header -->
    <header class="header-relatorios">
        <div class="header-left">
            <button onclick="voltarParaProfessor()" class="btn-voltar">‚Üê Voltar</button>
            <div class="titulo-header">
                <h1>Relat√≥rios de Frequ√™ncia</h1>
                <span id="turma-relatorio">Turma: 1¬∫ Ano A</span>
            </div>
        </div>
        <div class="header-right">
            <span id="data-relatorio"></span>
        </div>
    </header>

    <!-- Filtros -->
    <section class="filtros-section">
        <div class="filtros-container">
               <div class="filtro-group">
            <label>Turma:</label>
            <select id="filtro-turma">
                <option value="">Carregando turmas...</option>
            </select>
        </div>
        
    
            <div class="filtro-group">
                <label>M√™s:</label>
                <select id="filtro-mes">
                    <option value="0">Janeiro</option>
                    <option value="1">Fevereiro</option>
                    <option value="2">Mar√ßo</option>
                    <option value="3">Abril</option>
                    <option value="4">Maio</option>
                    <option value="5">Junho</option>
                    <option value="6">Julho</option>
                    <option value="7">Agosto</option>
                    <option value="8">Setembro</option>
                    <option value="9">Outubro</option>
                    <option value="10">Novembro</option>
                    <option value="11">Dezembro</option>
                </select>
            </div>
            
            <div class="filtro-group">
                <label>Ano:</label>
                <select id="filtro-ano">
                    <option value="2024">2024</option>
                    <option value="2025">2025</option>
                </select>
            </div>
            
            <div class="filtro-group">
                <label>Aluno:</label>
                <select id="filtro-aluno">
                    <option value="todos">Todos os Alunos</option>
                </select>
            </div>
            
            <button onclick="carregarRelatorios()" class="btn-carregar">üìä Gerar Relat√≥rio</button>
        </div>
    </section>

    <!-- Resumo Geral -->
    <section class="resumo-section">
        <h2>üìà Resumo Geral</h2>
        <div class="resumo-cards">
            <div class="resumo-card total">
                <div class="resumo-icon">üë•</div>
                <div class="resumo-info">
                    <span class="resumo-valor" id="total-alunos">0</span>
                    <span class="resumo-label">Total de Alunos</span>
                </div>
            </div>
            
            <div class="resumo-card presentes">
                <div class="resumo-icon">‚úÖ</div>
                <div class="resumo-info">
                    <span class="resumo-valor" id="total-presentes">0</span>
                    <span class="resumo-label">Total Presentes</span>
                </div>
            </div>
            
            <div class="resumo-card ausentes">
                <div class="resumo-icon">‚ùå</div>
                <div class="resumo-info">
                    <span class="resumo-valor" id="total-ausentes">0</span>
                    <span class="resumo-label">Total Ausentes</span>
                </div>
            </div>
            
            <div class="resumo-card percentual">
                <div class="resumo-icon">üìä</div>
                <div class="resumo-info">
                    <span class="resumo-valor" id="percentual-presenca">0%</span>
                    <span class="resumo-label">Percentual de Presen√ßa</span>
                </div>
            </div>
        </div>
    </section>

    <!-- Tabela de Detalhes -->
    <section class="detalhes-section">
        <h2>üìã Detalhes por Aluno</h2>
        <div class="tabela-container">
            <table class="tabela-relatorio">
                <thead>
                    <tr>
                        <th>Aluno</th>
                        <th>Presentes</th>
                        <th>Ausentes</th>
                        <th>Total Dias</th>
                        <th>% Presen√ßa</th>
                        <th>Status</th>
                    </tr>
                </thead>
                <tbody id="corpo-tabela">
                    <!-- Dados ser√£o preenchidos pelo JavaScript -->
                </tbody>
            </table>
        </div>
    </section>

    <!-- Detalhes por Data -->
    <section class="detalhes-data-section">
        <h2>üìÖ Detalhes por Data</h2>
        <div class="dias-container" id="dias-container">
            <!-- Detalhes por data ser√£o preenchidos pelo JavaScript -->
        </div>
    </section>

    <script>
// ‚úÖ CORRE√á√ÉO: URL autom√°tica para produ√ß√£o/desenvolvimento
const API_URL = window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1'
  ? 'http://localhost:3000'
  : 'http://projetosemeddiariodigital-production.up.railway.app'; // ‚ö†Ô∏è SUBSTITUA pelo URL REAL do Railway depois!

// Fun√ß√£o auxiliar para fetch com tratamento de erro
async function apiFetch(url, options = {}) {
  try {
    const response = await fetch(`${API_URL}${url}`, {
      ...options,
      credentials: 'include'
    });
    return response;
  } catch (error) {
    console.error('Erro na requisi√ß√£o:', error);
    throw error;
  }
}
</script>


    <script src="script-relatorios.js"></script>
</body>
</html>
